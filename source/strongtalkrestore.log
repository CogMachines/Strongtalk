
"November 2, 2008 -> 22:35:15"!

! (Delta mirrorFor: #VM) classSide methodsFor: 'allocation' !
newDoubleBytes: doubleByteClass size: size

	^{{primitiveIndexedDoubleByteNew: doubleByteClass
			size: size
			tenured: false
			ifFail: [:e| self handleNewDoubleBytes: doubleByteClass
										size: size
										failure: e]}}! !

"November 2, 2008 -> 22:37:33"!

! (Delta mirrorFor: #VM) classSide methodsFor: 'private - allocation' !
newDoubleBytes: class size: size tenured: tenured ifFail: failureBlock

	^{{primitiveIndexedDoubleByteNew: class
			size: size
			tenured: tenured
			ifFail: [:e| failureBlock value: e]}}! !

"November 2, 2008 -> 22:37:39"!

! (Delta mirrorFor: #VM) classSide methodsFor: 'private - allocation' !
handleNewDoubleBytes: class size: size failure: error

	self incFailureCount.
	^self handleFailure: error
			allocate: [:tenured :failBlock|
								self newDoubleBytes: class
										size: size
										tenured: tenured
										ifFail: failBlock]
			ifExpand: [self expandDoubleBytes: class size: size]! !

"November 2, 2008 -> 22:37:42"!

! (Delta mirrorFor: #VM) classSide methodsFor: 'private - allocation' !
expandDoubleBytes: class size: size

	|nonIndexableSizeInOops|
	nonIndexableSizeInOops := self fixedSize: class.
	self expand: (nonIndexableSizeInOops * self oopSize + (size * 2))! !

"November 2, 2008 -> 22:42:23"!

! (Delta mirrorFor: #VM) classSide methodsFor: 'allocation' !
newDoubleBytes: doubleByteClass size: size

	^{{primitiveIndexedDoubleByteNew: doubleByteClass
			size: size
			tenured: false
			ifFail: [:e| self handleNewDoubleBytes: doubleByteClass
										size: size
										failure: e]}}! !

"November 2, 2008 -> 22:42:23"!

! (Delta mirrorFor: #VM) classSide methodsFor: 'private - allocation' !
newDoubleBytes: class size: size tenured: tenured ifFail: failureBlock

	^{{primitiveIndexedDoubleByteNew: class
			size: size
			tenured: tenured
			ifFail: [:e| failureBlock value: e]}}! !

"November 2, 2008 -> 22:42:23"!

! (Delta mirrorFor: #VM) classSide methodsFor: 'private - allocation' !
handleNewDoubleBytes: class size: size failure: error

	self incFailureCount.
	^self handleFailure: error
			allocate: [:tenured :failBlock|
								self newDoubleBytes: class
										size: size
										tenured: tenured
										ifFail: failBlock]
			ifExpand: [self expandDoubleBytes: class size: size]! !

"November 2, 2008 -> 22:42:23"!

! (Delta mirrorFor: #VM) classSide methodsFor: 'private - allocation' !
expandDoubleBytes: class size: size

	|nonIndexableSizeInOops|
	nonIndexableSizeInOops := self fixedSize: class.
	self expand: (nonIndexableSizeInOops * self oopSize + (size * 2))! !
